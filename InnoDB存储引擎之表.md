---
   title: 《InnoDB存储引擎》之表
   date: 2019-12-26 15:34:00
   tags: 读书笔记
---
简单来说，表就是关于特定实体的数据集合，是关系型数据库模型的核心。我们继续看书，这篇文章记录下InnoDB存储引擎表的逻辑存储以及实现这一章节的知识点。

## 第四章 表
### 索引组织表
在InnoDB存储引擎中，表都是根据主键顺序组织存放的，这种存储方式的表成为索引组织表。在InnoDB存储引擎中，每张表都有个主键，如果在创建时没有显式地定义主键，则InnoDB存储引擎会按照如下方式选择或创建主键：
- 首先判断表中是否有非空的唯一索引，如果有，则该列即为主键；
- 如果不符合上述条件，InnoDB存储引擎自动创建一个6字节大小的指针。
<!-- more -->

### 逻辑存储结构
从InnoDB存储引擎的逻辑存储结构看，所有数据都被逻辑地存放在一个空间中，称之为表空间。表空间又由段，区，页组成。
![](http://pic.evilhex.com/blog/15773470526725.jpg)

表空间可以看做是InnoDB存储引擎逻辑结构的最高层，所有的数据都存放在表空间中。表空间是由段组成的，常见的段有数据段、索引段、回滚段等。前面已经介绍过了InnoDB存储引擎是索引组织的，因此数据即索引，索引即数据。数据段即为B+树的叶子节点，索引段即为B+树的非索引节点。

区是由连续页组成的空间，在任何情况下每个区的大小都为1M。为了保证区中页的连续性，InnoDB存储引擎一次从磁盘申请4～5个区。同大多数数据库一样，InnoDB有页的概念，也是InnoDB磁盘管理的最小单位。在InnoDB存储引擎中，常见的页类型有：
- 数据页
- undo页
- 系统页
- 事务数据页
- 插入缓冲位图页
- 插入缓冲空闲列表页
- 未压缩的二进制大对象页
- 压缩的二进制大对象页

InnoDB存储引擎是面向列的，也就是说按行进行存放的，提供了Compact和Redundant两种格式来存放记录数据。Compact行记录是在MySQL5.0中引入的，其设计的目的是高效地存储数据。简单来说，一个页中存放的行数越多，其性能就越高。
### 数据页结构
页是InnoDB存储引擎管理数据库的最小磁盘单位。InnoDB数据页由以下7个部分组成：
![](http://pic.evilhex.com/blog/15773513716826.jpg)
- File Header 文件头
- Page Header 页头
- Infimum和Supermum Records
- User Records 用户记录
- Free Space 空闲空间
- Page Directory 页目录
- File Trailer 文件结尾信息
看了这本书，最大的收获就是不迷信书本，写的什么垃圾东西，没有层级结构，看着实在难受，这一章果断舍弃之。














